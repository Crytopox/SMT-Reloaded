<Window x:Class="SMT.SovUpgradeFilterWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Infrastructure Upgrade Filters" Height="720" Width="560"
        WindowStartupLocation="CenterOwner" ResizeMode="CanResizeWithGrip">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="0,0,0,8">
            <TextBlock Text="Select which upgrade icons to display on the map." />
            <TextBlock Text="If all are selected, all upgrades are shown." Opacity="0.7" />
        </StackPanel>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <ItemsControl x:Name="UpgradeList" ItemsSource="{Binding UpgradeCategories}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <GroupBox Header="{Binding Name}" Margin="0,0,0,8">
                            <StackPanel>
                                <ItemsControl ItemsSource="{Binding Items}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <UniformGrid Columns="2" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding IsChecked}" Margin="4,2">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="{Binding Icon}" Width="18" Height="18" Margin="0,0,6,0" />
                                                    <TextBlock Text="{Binding DisplayName}" VerticalAlignment="Center" />
                                                </StackPanel>
                                            </CheckBox>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>

                                <ItemsControl ItemsSource="{Binding SubGroups}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <GroupBox Header="{Binding Name}" Margin="0,4,0,6">
                                                <ItemsControl ItemsSource="{Binding Items}">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <UniformGrid Columns="2" />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <CheckBox IsChecked="{Binding IsChecked}" Margin="4,2">
                                                                <StackPanel Orientation="Horizontal">
                                                                    <Image Source="{Binding Icon}" Width="18" Height="18" Margin="0,0,6,0" />
                                                                    <TextBlock Text="{Binding DisplayName}" VerticalAlignment="Center" />
                                                                </StackPanel>
                                                            </CheckBox>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </GroupBox>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </GroupBox>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,6,0,0">
            <Button Content="All" Width="60" Height="24" Margin="0,0,6,0" Click="SelectAll_Click" />
            <Button Content="Clear" Width="60" Height="24" Margin="0,0,6,0" Click="ClearAll_Click" />
            <Button Content="Apply" Width="70" Height="24" Margin="0,0,6,0" Click="Apply_Click" />
            <Button Content="Cancel" Width="70" Height="24" IsCancel="True" />
        </StackPanel>
    </Grid>
</Window>
